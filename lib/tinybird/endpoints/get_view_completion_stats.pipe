VERSION 1

NODE endpoint
SQL >
    %
    SELECT
        viewId,
        versionNumber,
        COUNT(DISTINCT pageNumber) as pages_viewed
    FROM page_views__v3
    WHERE
        documentId = {{ String(documentId, required=True) }}
        AND viewId NOT IN splitByChar(',', {{ String(excludedViewIds, required=True) }})
        AND time >= {{ Int64(since, required=True) }}
    GROUP BY viewId, versionNumber
